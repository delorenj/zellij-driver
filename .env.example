# ============================================================================
# Hybrid BMAD + Letta Architecture - Phase 1 Development Environment
# ============================================================================
#
# Copy this file to .env and fill in the values
# DO NOT commit .env to version control
#
# Generate secure passwords: openssl rand -base64 32
#
# ============================================================================

# ----------------------------------------------------------------------------
# PostgreSQL Event Store Configuration
# ----------------------------------------------------------------------------

# Database credentials
POSTGRES_PASSWORD=your_secure_postgres_password_here

# Connection string (used by Python/Node services)
# Port 5435 for zellij-driver to avoid conflicts with other 33GOD services
DATABASE_URL=postgresql://event_store:${POSTGRES_PASSWORD}@localhost:5435/event_store

# Database pool settings (optional, defaults provided in services)
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40

# ----------------------------------------------------------------------------
# RabbitMQ (Bloodbank Event Bus) Configuration
# ----------------------------------------------------------------------------

# RabbitMQ credentials
RABBITMQ_USER=bloodbank
RABBITMQ_PASSWORD=your_secure_rabbitmq_password_here

# Erlang cookie for clustering (single-node dev, but required)
RABBITMQ_ERLANG_COOKIE=bloodbank-secret-cookie-change-me

# Connection URL (AMQP)
# Port 5675 for zellij-driver to avoid conflicts with other 33GOD services
RABBITMQ_URL=amqp://${RABBITMQ_USER}:${RABBITMQ_PASSWORD}@localhost:5675

# Management UI
# Port 15675 for zellij-driver to avoid conflicts
RABBITMQ_MANAGEMENT_URL=http://localhost:15675

# Exchange configuration (defined in services)
BLOODBANK_EXCHANGE=bloodbank.events.v1
BLOODBANK_EXCHANGE_TYPE=topic

# ----------------------------------------------------------------------------
# Redis Configuration
# ----------------------------------------------------------------------------

# Redis connection
# Port 6382 for zellij-driver to avoid conflicts with other 33GOD services
REDIS_URL=redis://localhost:6382/0

# Redis pool settings (optional)
REDIS_MAX_CONNECTIONS=50
REDIS_POOL_SIZE=10

# ----------------------------------------------------------------------------
# Event Store Manager Configuration (STORY-004, STORY-005, STORY-006)
# ----------------------------------------------------------------------------

# Service configuration
EVENT_STORE_MANAGER_HOST=0.0.0.0
EVENT_STORE_MANAGER_PORT=8081

# Queue configuration
EVENT_STORE_MANAGER_QUEUE=event_store_manager_queue
EVENT_STORE_MANAGER_DLQ=event_store_manager_dlq

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json

# ----------------------------------------------------------------------------
# Event Store API Configuration (STORY-007, STORY-008, STORY-009)
# ----------------------------------------------------------------------------

# API server
EVENT_STORE_API_HOST=0.0.0.0
EVENT_STORE_API_PORT=8080

# API configuration
API_PREFIX=/api/v1
API_CORS_ORIGINS=http://localhost:3000,http://localhost:3360

# Query limits
API_DEFAULT_PAGE_SIZE=100
API_MAX_PAGE_SIZE=1000
API_MAX_CAUSATION_DEPTH=100

# WebSocket configuration
WS_HEARTBEAT_INTERVAL_SECONDS=30
WS_MAX_CONNECTIONS=100

# ----------------------------------------------------------------------------
# Letta Configuration (STORY-011)
# ----------------------------------------------------------------------------

# Letta server (self-hosted)
LETTA_SERVER_URL=http://localhost:8283
LETTA_API_KEY=your_letta_api_key_here

# Letta agent configuration
LETTA_CHECKPOINT_INTERVAL_MESSAGES=50
LETTA_CHECKPOINT_INTERVAL_MINUTES=10
LETTA_DEFAULT_MODEL=claude-sonnet-4-5

# Letta queue
LETTA_HANDOFF_QUEUE=letta_handoff_queue

# ----------------------------------------------------------------------------
# BMAD Configuration (STORY-010)
# ----------------------------------------------------------------------------

# BMAD event publishing
BMAD_PUBLISH_EVENTS=true
BMAD_SOURCE_HOST=localhost
BMAD_SOURCE_APP=bmad-orchestrator

# ----------------------------------------------------------------------------
# Development / Testing Configuration
# ----------------------------------------------------------------------------

# Environment
ENVIRONMENT=development

# Feature flags
ENABLE_DEBUG_LOGGING=true
ENABLE_PROFILING=false
ENABLE_METRICS=true

# Testing
TEST_DATABASE_URL=postgresql://event_store:test_password@localhost:5432/event_store_test

# ----------------------------------------------------------------------------
# Production / Security Configuration (Phase 5)
# ----------------------------------------------------------------------------

# JWT Authentication (future)
# JWT_SECRET=your_jwt_secret_here
# JWT_ALGORITHM=HS256
# JWT_EXPIRATION_MINUTES=60

# Rate limiting (future)
# RATE_LIMIT_REQUESTS_PER_MINUTE=60
# RATE_LIMIT_BURST=10

# Circuit breaker (future)
# CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
# CIRCUIT_BREAKER_TIMEOUT_SECONDS=60

# ============================================================================
# NOTES
# ============================================================================
#
# 1. Security:
#    - Use strong, unique passwords for each service
#    - Generate with: openssl rand -base64 32
#    - Rotate credentials regularly
#    - Never commit .env to version control
#
# 2. Connection URLs:
#    - Use ${VAR} syntax to reference other variables
#    - Update hostnames for production deployment
#    - Docker services use container names (postgres, rabbitmq, redis)
#    - Local development uses localhost
#
# 3. Service Discovery:
#    - PostgreSQL: localhost:5432 (host) or postgres:5432 (container)
#    - RabbitMQ: localhost:5672/15672 or rabbitmq:5672/15672
#    - Redis: localhost:6379 or redis:6379
#
# 4. Phase 1 Focus:
#    - Only PostgreSQL, RabbitMQ, Redis are required initially
#    - Event Store Manager, API, and Letta integration come in later stories
#    - Configuration provided for forward compatibility
#
# ============================================================================
